<link rel="import" href="https://wasabi.i3s.unice.fr/plugins/delay-plugin/WebAudioPluginBank/bower_components/webaudio-controls/webaudio-controls.html">
<link rel="import" href="./js/pedal-behavior.html">
<link rel="import" href="https://wasabi.i3s.unice.fr/plugins/delay-plugin/WebAudioPluginBank/wc-delay.html">

<dom-module id="pedal-delay">
  <template>
    <style include="shared-styles">
      :host {
        background-color: #5aaa60;
        background: linear-gradient(#009688, #004d40);
      }
    </style>

    <div class="laPedale">
      <div class="elements">
        <wc-pingpongdelay id="WCdelay"></wc-pingpongdelay>
      </div>
    </div>
  </template>
  <script>
    class PedalDelay extends PBPlugin(Polymer.Element) {
      static get is() {
        return 'pedal-delay';
      }
      static get properties() {
        return {
          dataWidth: {
            type: Number,
            value: 120
          },
          dataHeight: {
            type: Number,
            value: 180
          }
        };
      }
      
      ready() {
        super.ready();
        this.createAllInternNodes();
        //this.connectInternNodes();
        //this.resetKnobs();
        //this.setKnobsListeners();
        //this.setValuesToKnobs();
        //this.setPedalActive();
        //this.setSwitchListener();
      }
      createAllInternNodes() {
        this.$.WCdelay.buildGraph(GlobalContext.context);
        console.log(this.$.WCdelay.getEffect());
        this.soundNodeIn.connect(this.$.WCdelay.getEffect().getInputNode());
        this.$.WCdelay.getEffect().getOutputNode().connect(this.soundNodeOut);
      }
      getDefaultButtonsValues() {
        return {
          feedback: 50,
          time: 30,
          mix: 50
        };
      }
      bypass() {
        this.$.WCdelay.bypass();
      }
      reactivate() {
        this.$.WCdelay.reactivate();
      }
    }
    // Register the x-custom element with the browser
    customElements.define(PedalDelay.is, PedalDelay);
  </script>
</dom-module>